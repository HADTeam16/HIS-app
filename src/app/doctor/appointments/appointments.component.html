<div class="h-full w-full flex justify-evenly">
    <div class="w-1/5">
        <mat-calendar
            [selected]="selectedDate"
            (selectedChange)="onDateChange($event)"
        />
        <button mat-button (click)="setToday()">Today</button>
        <button mat-button (click)="setTomorrow()">Tomorrow</button>
    </div>
    <mat-divider [vertical]="true"></mat-divider>
    <div class="w-2/3 mt-8" *ngIf="isLoading; else notLoadingContent">
        <mat-spinner></mat-spinner>
    </div>
    <ng-template #notLoadingContent>
        <div class="w-2/3 mt-8">
            <mat-button-toggle-group
                value="all"
                name="appointmentStatus"
                (change)="onStatusToggle($event)"
                class="mb-8"
            >
                <mat-button-toggle value="all">All</mat-button-toggle>
                <mat-button-toggle value="upcoming">Upcoming</mat-button-toggle>
                <mat-button-toggle value="completed"
                    >Completed</mat-button-toggle
                >
            </mat-button-toggle-group>
            <ng-template #noAppointmentsFound>
                <div>
                    <span class="text-xl">No Appointments found!</span>
                </div>
            </ng-template>
            <div
                *ngIf="displayAppointments.length > 0; else noAppointmentsFound"
            >
                <mat-accordion>
                    <mat-expansion-panel
                        *ngFor="let appointment of displayAppointments"
                    >
                        <mat-expansion-panel-header>
                            <mat-panel-title>
                                {{
                                    "P" +
                                        appointment.patientId
                                            .toString()
                                            .padStart(4, "0")
                                }}
                            </mat-panel-title>
                            <mat-panel-description>
                                {{ formatTime(appointment.slot) }}
                            </mat-panel-description>
                        </mat-expansion-panel-header>
                        <div class="flex w-2/3 justify-between">
                            <section>
                                Appointment ID:
                                {{
                                    "A" +
                                        appointment.appointmentId
                                            .toString()
                                            .padStart(4, "0")
                                }}
                                <br />
                                Name: {{ appointment.name }}<br />
                                Age: {{ appointment.age }}<br />
                                Gender: {{ appointment.gender }}
                            </section>
                            <section>
                                Contact: {{ appointment.contact }}<br />
                                Purpose:
                                {{
                                    appointment.purpose
                                        ? appointment.purpose
                                        : "-"
                                }}<br />
                                Temperature:
                                {{
                                    appointment.temperature
                                        ? appointment.temperature
                                        : "-"
                                }}<br />
                                Blood Pressure:
                                {{
                                    appointment.bloodPressure
                                        ? appointment.bloodPressure
                                        : "-"
                                }}
                            </section>
                        </div>
                        <br />
                        <mat-action-row>
                            <button
                                *ngIf="isToday"
                                mat-raised-button
                                color="primary"
                                (click)="
                                    finishAppointment(appointment.appointmentId)
                                "
                            >
                                Finish Appointment
                            </button>
                            <button
                                mat-stroked-button
                                color="primary"
                                (click)="viewHistory(appointment.patientId)"
                            >
                                View Patient History
                            </button>
                        </mat-action-row>
                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </div>
    </ng-template>
</div>
